From b68298e055c5e1ef352c31970b66f98c61690b89 Mon Sep 17 00:00:00 2001
From: Hannes Mann <hannesmann2000@gmail.com>
Date: Tue, 7 Mar 2023 03:55:46 +0100
Subject: [PATCH] effects: Don't animate internal windows

---
 src/effects/glide/glide.cpp                     | 3 ++-
 src/effects/scale/package/contents/code/main.js | 3 ++-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/effects/glide/glide.cpp b/src/effects/glide/glide.cpp
index a17e30d75c..15aaec1c85 100644
--- a/src/effects/glide/glide.cpp
+++ b/src/effects/glide/glide.cpp
@@ -309,7 +309,8 @@ bool GlideEffect::isGlideWindow(EffectWindow *w) const
     // to use a heuristic: if a window has decoration, then it's most
     // likely a dialog or a settings window so we have to animate it.
     if (w->windowClass() == QLatin1String("plasmashell plasmashell")
-        || w->windowClass() == QLatin1String("plasmashell org.kde.plasmashell")) {
+        || w->windowClass() == QLatin1String("plasmashell org.kde.plasmashell")
+        || w->internalWindow()) {
         return w->hasDecoration();
     }
 
diff --git a/src/effects/scale/package/contents/code/main.js b/src/effects/scale/package/contents/code/main.js
index eb97629b0e..0a65a3b1ab 100644
--- a/src/effects/scale/package/contents/code/main.js
+++ b/src/effects/scale/package/contents/code/main.js
@@ -45,7 +45,8 @@ class ScaleEffect {
         // to use a heuristic: if a window has decoration, then it's most
         // likely a dialog or a settings window so we have to animate it.
         if (window.windowClass == "plasmashell plasmashell"
-                || window.windowClass == "plasmashell org.kde.plasmashell") {
+                || window.windowClass == "plasmashell org.kde.plasmashell"
+                || window.internalWindow !== null) {
             return window.hasDecoration;
         }
 
-- 
2.40.0

